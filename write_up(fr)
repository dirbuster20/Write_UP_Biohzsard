NMAP SCAN

ports 3

22,21,80
******************************
emblem flag

/diningRoom  press YES 
emblem{flag}
********************************

lock pick flag

source code 
	<!-- It is in the /diningRoom/ -->
in /dingingRoom/
<!-- SG93IGFib3V0IHRoZSAvdGVhUm9vbS8= --> base64 -d = teaRoom
in /teaRoom  = href to <a href="master_of_unlock.html">Lockpick</a>

in Lopick = lock_pick(flag)--> flag
 ******************************************************************************
 
music Flag, check in /artRoom:

Location:
/diningRoom/
/teaRoom/
/artRoom/
/barRoom/
/diningRoom2F/
/tigerStatusRoom/
/galleryRoom/
/studyRoom/
/armorRoom/
/attic/

/BarRoom/
NV2XG2LDL5ZWQZLFOR5TGNRSMQ3TEZDFMFTDMNLGGVRGIYZWGNSGCZLDMU3GCMLGGY3TMZL5 =b32 so use cyberchef:
music_sheet{flag}
**************************************************************************************************

gold_emblem flag
Then submit and get
gold_emblem{flag}

**************************************************************************************************

flag shield :

go diningRoom, submit  the gold_emblem galg --> klfvg ks r wimgnd biz mpuiui ulg fiemok tqod. Xii jvmc tbkg ks tempgf tyi_hvgct_jljinf_kvc
look hints then you can conclude that is a Cyphère vignère 

URL to decode:
https://www.boxentriq.com/code-breaking/vigenere-cipher

klfvg ks r wimgnd biz mpuiui ulg fiemok tqod. Xii jvmc tbkg ks tempgf tyi_hvgct_jljinf_kvc = there is a shield key inside the dining room the html page is called the great shield key
so we can go here:
/diningRoom/the_great_shield_key.html


shield_key{flag}
**************************************************************************************************

blue gem flag
:
 /dingingRoom2F 
 source code  :<!-- Lbh trg gur oyhr trz ol chfuvat gur fgnghf gb gur ybjre sybbe. Gur trz vf ba gur qvavatEbbz svefg sybbe. Ivfvg fnccuver.ugzy -->     
 it's ROT13 
 You get the blue gem by pushing the status to the lower floor. The gem is on the diningRoom first floor. Visit sapphire.html
 visit /diningRoom/sapphire.html
 
blue_jewel{flag} 
**************************************************************************************************

ftp username

different step:

in /tigerStatusRoom/

crest 1:
S0pXRkVVS0pKQkxIVVdTWUpFM0VTUlk9
Hint 1: Crest 1 has been encoded twice
Hint 2: Crest 1 contanis 14 letters
Note: You need to collect all 4 crests, combine and decode to reavel another path
The combination should be crest 1 + crest 2 + crest 3 + crest 4. Also, the combination is a type of encoded base and you need to decode it

cyberchef

S0pXRkVVS0pKQkxIVVdTWUpFM0VTUlk9 (base64)
KJWFEUKJJBLHUWSYJE3ESRY= (base32)
RlRQIHVzZXI6IG (final)

**************************************************************************************************

/galleryRoom
Crest 2:
GVFWK5KHK5WTGTCILE4DKY3DNN4GQQRTM5AVCTKE
Hint 1: Crest 2 has been encoded twice
Hint 2: Crest 2 contanis 18 letters

GVFWK5KHK5WTGTCILE4DKY3DNN4GQQRTM5AVCTKE (base32)
5KeuGWm3LHY85cckxhB3gAQMD (base58)
h1bnRlciwgRlRQIHBh (final)

**************************************************************************************************

/amorRoom
Crest 3:
MDAxMTAxMTAgMDAxMTAwMTEgMDAxMDAwMDAgMDAxMTAwMTEgMDAxMTAwMTEgMDAxMDAwMDAgMDAxMTAxMDAgMDExMDAxMDAgMDAxMDAwMDAgMDAxMTAwMTEgMDAxMTAxMTAgMDAxMDAwMDAgMDAxMTAxMDAgMDAxMTEwMDEgMDAxMDAwMDAgMDAxMTAxMDAgMDAxMTEwMDAgMDAxMDAwMDAgMDAxMTAxMTAgMDExMDAwMTEgMDAxMDAwMDAgMDAxMTAxMTEgMDAxMTAxMTAgMDAxMDAwMDAgMDAxMTAxMTAgMDAxMTAxMDAgMDAxMDAwMDAgMDAxMTAxMDEgMDAxMTAxMTAgMDAxMDAwMDAgMDAxMTAwMTEgMDAxMTEwMDEgMDAxMDAwMDAgMDAxMTAxMTAgMDExMDAwMDEgMDAxMDAwMDAgMDAxMTAxMDEgMDAxMTEwMDEgMDAxMDAwMDAgMDAxMTAxMDEgMDAxMTAxMTEgMDAxMDAwMDAgMDAxMTAwMTEgMDAxMTAxMDEgMDAxMDAwMDAgMDAxMTAwMTEgMDAxMTAwMDAgMDAxMDAwMDAgMDAxMTAxMDEgMDAxMTEwMDAgMDAxMDAwMDAgMDAxMTAwMTEgMDAxMTAwMTAgMDAxMDAwMDAgMDAxMTAxMTAgMDAxMTEwMDA= (base64 > binary)
Hint 1: Crest 3 has been encoded three times
Hint 2: Crest 3 contanis 19 letters

63 33 4d 36 49 48 6c 76 64 56 39 6a 59 57 35 30 58 32 68 (HEX)
c3M6IHlvdV9jYW50X2h (final)

**************************************************************************************************

Crest 4:
gSUERauVpvKzRpyPpuYz66JDmRTbJubaoArM6CAQsnVwte6zF9J4GGYyun3k5qM9ma4s (base58)
Hint 1: Crest 2 has been encoded twice
Hint 2: Crest 2 contanis 17 characters

70 5a 47 56 66 5a 6d 39 79 5a 58 5a 6c 63 67 3d 3d (HEX)
pZGVfZm9yZXZlcg== (final)


Remember :
Note: You need to collect all 4 crests, combine and decode to reavel another path
The combination should be crest 1 + crest 2 + crest 3 + crest 4. Also, the combination is a type of encoded base and you need to decode it

CREST 1 + CREST 2 + CREST 3 + CREST 4 = 
RlRQIHVzZXI6IGh1bnRlciwgRlRQIHBhc3M6IHlvdV9jYW50X2hpZGVfZm9yZXZlcg== --> base64 --> FTP user: user, FTP pass: pass
FTP Access

**************************************************************************************************
Inside the FTP:

mget * get all fic
inside impotant.txt: I think the helmet key is inside the text file, but I have no clue on decrypting stuff. Also, I come across a /hidden_closet/ door but it was locked.

we need to get the key :

  key1 = cGxhbnQ0Ml9jYW -->  steghide extract -sf 001-key.jpg     
  key2 = 5fYmVfZGVzdHJveV9 --> strings
  key3 = 3aXRoX3Zqb2x0 --> binwalk 003-key.jpg -e, create zip, unzip = key3.txt 

Key1 + Key2 + Key 3 = Key

  key = cGxhbnQ0Ml9jYW5fYmVfZGVzdHJveV93aXRoX3Zqb2x0  | base 64 decode  = plant42_********************* --> is the password encrypted file
  gpg with the key and get the helmet flag
  
  **************************************************************************************************

  go in  /hiddenCloset/
  paste the helmet flag

  in Examine ssh password :T_virus_rules

 in READ  wpbwbxr wpkzg pltwnhro, txrks_xfqsxrd_bvv_fy_rvmexa_ajk
 it's again Cyphere Vignere  and we get:
 
  Key: albert	Text :weasker login password stars members are my guinea pig
  we found a user and a pass
  weasker:stars_**************************
  connect to ssh 
 
  sudo -l 
  User weasker may run the following commands on umbrella_corp:
    (ALL : ALL) ALL
To easy AHAH 

Sudo su  and you Root



 
